#! /bin/bash --posix

# usage ~ comment_line n COMMENT FILE
# uses COMMENT to comment out line n from file

declare -ir LINE_NUMBER="${1}"
declare -r COMMENT_VALUE=$2
wait ;
declare -i BEFORE_LINE_NUMBER=$((${LINE_NUMBER}-1))
declare -i AFTER_LINE_NUMBER=$((${LINE_NUMBER}+1))
declare -r THE_FILE="${3}"

if [[ ( -e "${THE_FILE}" ) ]] ; then
	if [[ ( -r "${THE_FILE}" ) ]] ; then
		if [[ ( -w "${THE_FILE}" ) ]] ; then
			head -n ${BEFORE_LINE_NUMBER} ${THE_FILE} || exit 1 ;
			head -n ${LINE_NUMBER} ${THE_FILE} | tail -n 1 | sed -r 's/^/'"${COMMENT_VALUE}"'/g' || exit 1 ;
			wait ;
			tail -n +${AFTER_LINE_NUMBER} ${THE_FILE} || exit 1 ;
			wait ;
		else
			echo "ERROR: ${THE_FILE} is not writeable." 1>&2 ; wait ;
			exit 4;
		fi
	else
		echo "ERROR: ${THE_FILE} can not be read." 1>&2 ; wait ;
		exit 3;
	fi
else
	echo "ERROR: ${THE_FILE} can not be found." 1>&2 ; wait ;
	exit 2;
fi

exit 0 ;